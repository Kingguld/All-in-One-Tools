<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Free online PDF and Word document editor. Upload, edit, and download documents with our modern text editor." />
  <meta name="keywords" content="PDF editor, Word editor, online text editor, document converter, free document editor" />
  <title>Modern PDF & Word Editor - Free Online Document Editing Tool</title>
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-example"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  
  <style>
    :root {
      --primary: #4361ee;
      --secondary: #3a0ca3;
      --accent: #7209b7;
      --light: #f8f9fa;
      --dark: #212529;
      --success: #4cc9f0;
      --warning: #f72585;
      --gray: #6c757d;
      --light-gray: #e9ecef;
      --gradient: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --radius: 12px;
    }

    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: #f8fafc;
      color: var(--dark);
      line-height: 1.6;
      min-height: 100vh;
    }

    .app { 
      max-width: 1200px; 
      margin: 0 auto; 
      padding: 20px; 
    }

    /* Header Styles */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      flex-wrap: wrap;
      gap: 20px;
    }

    .brand {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .logo {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      background: var(--gradient);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 20px;
      box-shadow: var(--shadow);
    }

    .brand-text h1 {
      font-size: 24px;
      font-weight: 700;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 5px;
    }

    .brand-text p {
      font-size: 14px;
      color: var(--gray);
    }

    .controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .btn {
      background: var(--gradient);
      color: white;
      padding: 12px 20px;
      border-radius: 10px;
      border: 0;
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 30px rgba(67, 97, 238, 0.2);
    }

    .btn.secondary {
      background: white;
      color: var(--primary);
      border: 2px solid var(--light-gray);
    }

    .btn.secondary:hover {
      background: var(--light);
    }

    .file-input { 
      display: none; 
    }

    /* AdSense Banner */
    .ad-container {
      width: 100%;
      background: white;
      border-radius: var(--radius);
      padding: 15px;
      margin: 20px 0;
      text-align: center;
      box-shadow: var(--shadow);
      border: 1px solid var(--light-gray);
    }

    .ad-label {
      font-size: 12px;
      color: var(--gray);
      text-transform: uppercase;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }

    .ad-banner {
      width: 100%;
      min-height: 90px;
      background: var(--light);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray);
      font-size: 14px;
    }

    /* Main Panel */
    .panel {
      background: white;
      border-radius: var(--radius);
      padding: 25px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
    }

    /* Toolbar */
    .toolbar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--light-gray);
      margin-bottom: 20px;
    }

    .tool {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--light-gray);
      background: white;
      min-width: 42px;
      min-height: 42px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tool:hover {
      background: var(--light);
      border-color: var(--primary);
      color: var(--primary);
    }

    .tool.select { 
      padding: 8px 10px; 
    }

    select {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--light-gray);
      background: white;
      cursor: pointer;
      font-family: inherit;
    }

    /* Editor */
    .editor-wrap {
      margin-top: 20px;
    }

    .editor {
      width: 100%;
      border-radius: var(--radius);
      padding: 20px;
      min-height: 400px;
      border: 1px solid var(--light-gray);
      background: white;
      overflow: auto;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
    }

    .editable {
      min-height: 350px;
      outline: none;
      padding: 10px;
    }

    .editable:focus {
      border-radius: 8px;
      background: #f8fbff;
    }

    .hint {
      font-size: 14px;
      color: var(--gray);
      margin-top: 15px;
      text-align: center;
      padding: 10px;
    }

    /* Instructions */
    .instructions {
      margin-top: 30px;
      padding: 20px;
      border-radius: var(--radius);
      background: var(--light);
      font-size: 14px;
      border-left: 4px solid var(--primary);
    }

    .instructions strong {
      color: var(--primary);
      display: block;
      margin-bottom: 10px;
      font-size: 16px;
    }

    .instructions p {
      margin-bottom: 10px;
    }

    /* Footer Actions */
    .footer-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 25px;
      padding-top: 20px;
      border-top: 1px solid var(--light-gray);
    }

    /* Notification */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 25px;
      background: var(--success);
      color: white;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      transform: translateX(150%);
      transition: transform 0.3s ease-out;
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.error {
      background: var(--warning);
    }

    .notification-icon {
      font-size: 20px;
    }

    /* Loading Animation */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: stretch;
      }
      
      .brand {
        justify-content: center;
        text-align: center;
        margin-bottom: 15px;
      }
      
      .controls {
        justify-content: center;
      }
      
      .toolbar {
        justify-content: center;
      }
      
      .footer-actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
        justify-content: center;
      }
    }

    /* Feature Highlights */
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }

    .feature-card {
      background: white;
      padding: 25px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      text-align: center;
      transition: transform 0.3s ease;
    }

    .feature-card:hover {
      transform: translateY(-5px);
    }

    .feature-icon {
      font-size: 40px;
      margin-bottom: 15px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .feature-card h3 {
      color: var(--primary);
      margin-bottom: 10px;
    }

    .feature-card p {
      color: var(--gray);
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header>
      <div class="brand">
        <div class="logo">ED</div>
        <div class="brand-text">
          <h1>Modern Document Editor</h1>
          <p>Edit PDF and Word documents online for free</p>
        </div>
      </div>
      <div class="controls">
        <label class="btn" for="fileInput">
          <span>üìÅ Upload Document</span>
        </label>
        <input id="fileInput" class="file-input" type="file" accept=".pdf,.docx,.doc,.txt" />
        <button class="btn secondary" id="downloadPdfBtn">
          <span>üìÑ Download PDF</span>
        </button>
        <button class="btn" id="downloadDocBtn">
          <span>üìù Download Word</span>
        </button>
      </div>
    </header>

    <!-- AdSense Banner -->
    <div class="ad-container">
      <div class="ad-label">Advertisement</div>
      <div class="ad-banner">
        Google AdSense Banner
      </div>
    </div>

    <!-- Feature Highlights -->
    <div class="features">
      <div class="feature-card">
        <div class="feature-icon">üìä</div>
        <h3>Easy Editing</h3>
        <p>Edit your documents with our powerful yet simple text editor</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üîÑ</div>
        <h3>Format Conversion</h3>
        <p>Convert between PDF and Word formats seamlessly</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">üíæ</div>
        <h3>Auto Save</h3>
        <p>Your work is automatically saved in your browser</p>
      </div>
    </div>

    <!-- Main Panel -->
    <div class="panel">
      <!-- Toolbar -->
      <div class="toolbar">
        <button class="tool" id="boldBtn" title="Bold"><strong>B</strong></button>
        <button class="tool" id="italicBtn" title="Italic"><em>I</em></button>
        <button class="tool" id="underlineBtn" title="Underline"><u>U</u></button>

        <select id="fontSize" class="tool select" title="Font Size">
          <option value="12px">Small</option>
          <option value="14px" selected>Normal</option>
          <option value="16px">Large</option>
          <option value="20px">X-Large</option>
          <option value="24px">XX-Large</option>
        </select>

        <select id="fontFamily" class="tool select" title="Font Family">
          <option value="Arial, sans-serif">Arial</option>
          <option value="Georgia, serif">Georgia</option>
          <option value="'Courier New', monospace">Courier New</option>
          <option value="'Times New Roman', serif">Times New Roman</option>
        </select>

        <input type="color" id="fontColor" value="#4361ee" hidden>
        <button class="tool" id="colorBtn" title="Text Color" style="color: #4361ee;">A</button>

        <input type="file" id="imgInsert" accept="image/*" hidden />
        <button class="tool" id="insertImgBtn" title="Insert Image">üñº</button>

        <button class="tool" id="clearBtn" title="Clear All">‚úñ</button>
      </div>

      <!-- Editor -->
      <div class="editor-wrap">
        <div class="editor">
          <div id="editor" class="editable" contenteditable="true">
            <h2 style="text-align:center;color:#4361ee">Welcome to Modern Document Editor</h2>
            <p style="text-align:center">Start by uploading a document or begin typing to create a new one</p>
            <p class="hint">This is a fully editable area. You can format text, insert images, and more.</p>
          </div>
        </div>
      </div>

      <!-- Middle AdSense Banner -->
      <div class="ad-container">
        <div class="ad-label">Advertisement</div>
        <div class="ad-banner">
          Google AdSense Rectangle
        </div>
      </div>

      <!-- Instructions -->
      <div class="instructions">
        <strong>How to use our Document Editor</strong>
        <p>‚Ä¢ Upload a PDF, DOCX, or DOC file. The editor will extract text for editing.</p>
        <p>‚Ä¢ Format text using the toolbar options: bold, italic, underline, font size, font family, and colors.</p>
        <p>‚Ä¢ Insert images by clicking the image icon in the toolbar.</p>
        <p>‚Ä¢ When finished, download your document as PDF or Word format.</p>
        <p>‚Ä¢ Your work is automatically saved to your browser's storage.</p>
      </div>

      <!-- Footer Actions -->
      <div class="footer-actions">
        <button class="btn secondary" id="previewBtn">
          <span>üëÅÔ∏è Print Preview</span>
        </button>
        <button class="btn" id="autosaveBtn">
          <span>üíæ Save to Browser</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <span class="notification-icon">‚úì</span>
    <span id="notificationText">Operation completed successfully</span>
  </div>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.17/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
  <script>
    // Initialize PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';
  </script>

  <!-- Core JS -->
  <script>
    const editor = document.getElementById("editor");
    const fileInput = document.getElementById("fileInput");
    const uploadBtn = document.querySelector('[for="fileInput"]');
    const colorBtn = document.getElementById("colorBtn");
    const autosaveBtn = document.getElementById("autosaveBtn");
    const previewBtn = document.getElementById("previewBtn");
    
    // Check if editor has content
    let hasContent = false;
    
    // Initialize buttons state
    updateButtonsState();

    // ‚úÖ Notification
    function showNotification(msg, type = "success") {
      const note = document.getElementById("notification");
      const text = document.getElementById("notificationText");
      text.textContent = msg;
      note.className = "notification show " + (type === "error" ? "error" : "");
      setTimeout(() => note.classList.remove("show"), 3000);
    }

    // ‚úÖ Formatting (using document.execCommand for better compatibility)
    function formatText(command, value = null) {
      document.execCommand(command, false, value);
      editor.focus();
      updateButtonsState();
      saveToLocalStorage();
    }
    
    document.getElementById("boldBtn").onclick = () => formatText('bold');
    document.getElementById("italicBtn").onclick = () => formatText('italic');
    document.getElementById("underlineBtn").onclick = () => formatText('underline');
    
    document.getElementById("fontSize").onchange = e => formatText('fontSize', e.target.value.replace('px', ''));
    document.getElementById("fontFamily").onchange = e => formatText('fontName', e.target.value.split(',')[0].replace(/'/g, ''));
    
    document.getElementById("colorBtn").onclick = () => document.getElementById("fontColor").click();
    document.getElementById("fontColor").onchange = e => {
      formatText('foreColor', e.target.value);
      colorBtn.style.color = e.target.value;
    };

    // ‚úÖ Image insert
    document.getElementById("insertImgBtn").onclick = () => document.getElementById("imgInsert").click();
    document.getElementById("imgInsert").onchange = e => {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = () => {
        formatText('insertImage', reader.result);
        saveToLocalStorage();
      };
      reader.readAsDataURL(file);
    };

    // ‚úÖ Clear editor
    document.getElementById("clearBtn").onclick = () => {
      if (confirm("Are you sure you want to clear the editor? All content will be lost.")) {
        editor.innerHTML = '<p><br></p>';
        hasContent = false;
        updateButtonsState();
        localStorage.removeItem('editorContent');
        showNotification("Editor cleared");
      }
    };

    // ‚úÖ File upload handling
    fileInput.addEventListener('change', handleFileUpload);
    uploadBtn.addEventListener('click', () => {
      fileInput.click();
    });

    async function handleFileUpload(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      // Check file type
      const fileName = file.name.toLowerCase();
      if (!fileName.endsWith('.pdf') && !fileName.endsWith('.docx') && !fileName.endsWith('.doc') && !fileName.endsWith('.txt')) {
        showNotification("Please upload a PDF, Word, or text document", "error");
        return;
      }
      
      try {
        // Show uploading state
        uploadBtn.innerHTML = '<span class="loading"></span> Uploading...';
        uploadBtn.disabled = true;
        
        let text = '';
        
        if (fileName.endsWith('.pdf')) {
          text = await extractTextFromPDF(file);
        } else if (fileName.endsWith('.docx') || fileName.endsWith('.doc')) {
          text = await extractTextFromDocx(file);
        } else if (fileName.endsWith('.txt')) {
          text = await extractTextFromTxt(file);
        }
        
        // Update editor content
        editor.innerHTML = text || '<p>No text could be extracted from this file.</p>';
        hasContent = true;
        updateButtonsState();
        saveToLocalStorage();
        
        showNotification("File uploaded successfully");
        
      } catch (error) {
        console.error("Error processing file:", error);
        showNotification("Error processing file: " + error.message, "error");
      } finally {
        // Reset UI state
        uploadBtn.innerHTML = '<span>üìÅ Upload Document</span>';
        uploadBtn.disabled = false;
        
        // Reset file input
        fileInput.value = '';
      }
    }

    // ‚úÖ PDF text extraction
    async function extractTextFromPDF(file) {
      return new Promise((resolve, reject) => {
        const fileReader = new FileReader();
        
        fileReader.onload = async function() {
          try {
            const typedArray = new Uint8Array(this.result);
            const pdf = await pdfjsLib.getDocument(typedArray).promise;
            
            let text = '';
            for (let i = 1; i <= pdf.numPages; i++) {
              const page = await pdf.getPage(i);
              const content = await page.getTextContent();
              text += content.items.map(item => item.str).join(' ') + '\n\n';
            }
            
            resolve(text);
          } catch (error) {
            reject(error);
          }
        };
        
        fileReader.onerror = reject;
        fileReader.readAsArrayBuffer(file);
      });
    }

    // ‚úÖ DOCX text extraction
    async function extractTextFromDocx(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        
        reader.onload = function(event) {
          const arrayBuffer = event.target.result;
          
          mammoth.extractRawText({ arrayBuffer })
            .then(result => resolve(result.value))
            .catch(reject);
        };
        
        reader.onerror = reject;
        reader.readAsArrayBuffer(file);
      });
    }

    // ‚úÖ TXT file extraction
    function extractTextFromTxt(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        
        reader.onload = function(event) {
          resolve(event.target.result);
        };
        
        reader.onerror = reject;
        reader.readAsText(file);
      });
    }

    // ‚úÖ Download PDF
    document.getElementById("downloadPdfBtn").onclick = () => {
      if (!hasContent) {
        showNotification("Editor is empty. Add some content first.", "error");
        return;
      }
      
      const opt = {
        margin: 0.5,
        filename: "document.pdf",
        image: { type: "jpeg", quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: "in", format: "letter", orientation: "portrait" }
      };
      
      // Create a clone of the editor to avoid modifying the original
      const contentClone = editor.cloneNode(true);
      
      // Remove contenteditable attributes from clone
      contentClone.querySelectorAll('[contenteditable]').forEach(el => {
        el.removeAttribute('contenteditable');
      });
      
      html2pdf().set(opt).from(contentClone).save();
      showNotification("PDF downloaded successfully");
    };

    // ‚úÖ Download Word
    document.getElementById("downloadDocBtn").onclick = () => {
      if (!hasContent) {
        showNotification("Editor is empty. Add some content first.", "error");
        return;
      }
      
      // Create a clone of the content to avoid modifying the original
      const contentClone = editor.cloneNode(true);
      
      // Remove contenteditable attributes from clone
      contentClone.querySelectorAll('[contenteditable]').forEach(el => {
        el.removeAttribute('contenteditable');
      });
      
      const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
                     "xmlns:w='urn:schemas-microsoft-com:office:word' " +
                     "xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Document</title></head><body>";
      const footer = "</body></html>";
      const source = header + contentClone.innerHTML + footer;
      
      const blob = new Blob(['\ufeff', source], { type: 'application/msword' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = "document.doc";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
      
      showNotification("Word document downloaded successfully");
    };

    // ‚úÖ Print Preview
    previewBtn.onclick = () => {
      if (!hasContent) {
        showNotification("Editor is empty. Add some content first.", "error");
        return;
      }
      
      const content = editor.innerHTML;
      const printWindow = window.open('', '_blank');
      printWindow.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Print Preview</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            img { max-width: 100%; }
          </style>
        </head>
        <body>
          ${content}
          <script>
            window.onload = function() {
              window.print();
            }
          <\/script>
        </body>
        </html>
      `);
      printWindow.document.close();
    };

    // ‚úÖ Autosave to browser storage
    function saveToLocalStorage() {
      if (editor.innerHTML.trim() !== '') {
        localStorage.setItem('editorContent', editor.innerHTML);
        hasContent = true;
        updateButtonsState();
      }
    }
    
    // Load from localStorage on page load
    function loadFromLocalStorage() {
      const savedContent = localStorage.getItem('editorContent');
      if (savedContent) {
        editor.innerHTML = savedContent;
        hasContent = true;
        updateButtonsState();
      }
    }
    
    // Toggle autosave
    let autosaveEnabled = false;
    autosaveBtn.onclick = () => {
      autosaveEnabled = !autosaveEnabled;
      
      if (autosaveEnabled) {
        autosaveBtn.innerHTML = '<span>üíæ Autosave: ON</span>';
        autosaveBtn.style.background = "#10b981";
        showNotification("Autosave enabled");
      } else {
        autosaveBtn.innerHTML = '<span>üíæ Save to Browser</span>';
        autosaveBtn.style.background = "";
        showNotification("Autosave disabled");
      }
    };
    
    // Update buttons state based on content
    function updateButtonsState() {
      const downloadButtons = document.querySelectorAll('#downloadPdfBtn, #downloadDocBtn, #previewBtn');
      downloadButtons.forEach(btn => {
        btn.disabled = !hasContent;
      });
    }
    
    // Listen for changes in the editor
    editor.addEventListener('input', () => {
      hasContent = editor.innerHTML.trim() !== '' && editor.innerHTML !== '<p><br></p>';
      updateButtonsState();
      
      if (autosaveEnabled) {
        saveToLocalStorage();
      }
    });
    
    // Load saved content on page load
    window.addEventListener('DOMContentLoaded', () => {
      loadFromLocalStorage();
      
      // Check if there's content in the editor after load
      hasContent = editor.innerHTML.trim() !== '' && editor.innerHTML !== '<p><br></p>';
      updateButtonsState();
      
      // Enable autosave by default
      autosaveEnabled = true;
      autosaveBtn.innerHTML = '<span>üíæ Autosave: ON</span>';
      autosaveBtn.style.background = "#10b981";
    });
  </script>
</body>
</html>

  
  
